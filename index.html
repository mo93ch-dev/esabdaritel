<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<!-- Ø¯Ú©Ù…Ù‡ Ø¶Ø±Ø¨Ø¯Ø± -->
<a href="https://mo93ch-dev.github.io/Aryapardakhttel" class="close-btn">âœ–</a>

<style>
.close-btn {
  position: fixed;
  top: 15px;
  right: 15px;
  background: red;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  font-weight: bold;
  text-decoration: none;
  z-index: 9999;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  transition: 0.2s;
}

.close-btn:hover {
  background: darkred;
  transform: scale(1.1);
}
</style>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ø¢Ø±ÛŒØ§ Ù¾Ø±Ø¯Ø§Ø®Øª</title>
<style>
:root{
--bg:#0e1621;
--card:#17212b;
--primary:#2AABEE;
--text:#ffffff;
--muted:#8f9ca8;
--success:#00c853;
--danger:#ff5252;
--greenWords:#00ff7f;
--totalBalance:#00c0ff;
}
body{margin:0;font-family:Tahoma;background:var(--bg);color:var(--text);}
header{background:var(--card);padding:18px;text-align:center;font-size:20px;font-weight:600;box-shadow:0 2px 10px rgba(0,0,0,0.4);}
.container{max-width:1000px;margin:auto;padding:20px;}
.card{background:var(--card);border-radius:14px;padding:18px;margin-bottom:18px;box-shadow:0 4px 20px rgba(0,0,0,0.4);}
h3{margin-top:0;font-size:15px;margin-bottom:10px;color:var(--muted);}
.boldLarge{font-weight:700;font-size:20px;color:var(--text);}
input,select{width:100%;padding:12px;margin-bottom:10px;border-radius:10px;border:none;background:#1f2c3a;color:white;font-size:14px;}
input:focus,select:focus{outline:2px solid var(--primary);}
button{padding:8px 10px;border:none;border-radius:8px;cursor:pointer;font-size:13px;margin:3px 2px;}
.btn-main{background:var(--primary);color:white;width:100%;padding:12px;font-weight:600;}
.btn-copy{background:#2d3e50;color:white;}
.btn-history{background:#374a5c;color:white;}
.btn-share{background:#455a64;color:white;}
.customer{padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.05);}
.balance{font-weight:600;margin-top:4px;font-size:15px;}
.status{font-size:12px;margin-right:6px;}
.pos{color:var(--success);}
.neg{color:var(--danger);}
.small{font-size:12px;color:var(--muted);margin-top:4px;}
.historyBox{display:none;background:#1f2c3a;padding:10px;border-radius:8px;margin-top:8px;font-size:12px;}
.summaryBox{display:flex;justify-content:space-between;margin-bottom:15px;}
.summaryBox div{background:#1f2c3a;padding:10px;border-radius:10px;flex:1;text-align:center;margin:0 5px;}
.summaryBox .debit{color:var(--danger);}
.summaryBox .credit{color:var(--success);}
.amountWords{color:var(--greenWords);font-size:13px;margin-bottom:5px;}
.toggleCustomer{cursor:pointer;display:flex;justify-content:space-between;align-items:center;}
.totalBalance{color:var(--totalBalance);}
</style>
</head>
<body>
<header>Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ø¢Ø±ÛŒØ§ Ù¾Ø±Ø¯Ø§Ø®Øª</header>

<div class="container">

<div class="card summaryBox">
<div id="totalAll" class="totalBalance">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ Ø³ÛŒØ³ØªÙ…: 0.00</div>
</div>

<div class="card">
  <div class="toggleCustomer" onclick="toggleCustomerForm()">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø´ØªØ±ÛŒ <span id="toggleArrow">â–¼</span></div>
  <div id="customerForm" style="display:none;margin-top:10px;">
    <input type="text" id="name" placeholder="Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ">
    <input type="text" id="phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
    <button class="btn-main" onclick="addCustomer()">Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ</button>
  </div>
</div>

<div class="card">
  <div class="toggleCustomer" onclick="toggleTransactionForm()">Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´ <span id="toggleTransactionArrow">â–¼</span></div>
  <div id="transactionForm" style="display:none;margin-top:10px;">
    <select id="customerSelect">
      <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø´ØªØ±ÛŒ</option>
    </select>
    <select id="type">
      <option value="deposit">Ù¾Ø±Ø¯Ø§Ø®Øª</option>
      <option value="withdraw">Ø¨Ø±Ø¯Ø§Ø´Øª</option>
    </select>
    <input type="text" id="amount" placeholder="Ù…Ø¨Ù„Øº" oninput="handleAmountInput(this)">
    <div class="amountWords" id="amountWords"></div>
    <button class="btn-main" onclick="addTransaction()">Ø«Ø¨Øª</button>
  </div>
</div>

<div class="card summaryBox">
<div id="totalDebit" class="debit">Ø¬Ù…Ø¹ Ú©Ù„ Ø¨Ø¯Ù‡Ú©Ø§Ø±ÛŒ: 0.00</div>
<div id="totalCredit" class="credit">Ø¬Ù…Ø¹ Ú©Ù„ Ø·Ù„Ø¨Ú©Ø§Ø±ÛŒ: 0.00</div>
</div>

<div class="card">
<h3>ğŸ” Ø¬Ø³ØªØ¬Ùˆ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h3>
<input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù…..." oninput="render()">
</div>

<div class="card">
<h3>Ù„ÛŒØ³Øª Ù…Ø´ØªØ±ÛŒØ§Ù†</h3>
<div id="customerList"></div>
</div>

</div>

<script>
let customers=JSON.parse(localStorage.getItem("DarkTelegramProAccounting"))||[];

function save(){localStorage.setItem("DarkTelegramProAccounting",JSON.stringify(customers));}
function precise(n){return Number(n.toFixed(2));}

function numberToWords(num){
if(isNaN(num)) return "";
const ones=["","ÛŒÚ©","Ø¯Ùˆ","Ø³Ù‡","Ú†Ù‡Ø§Ø±","Ù¾Ù†Ø¬","Ø´Ø´","Ù‡ÙØª","Ù‡Ø´Øª","Ù†Ù‡"];
const tens=["","Ø¯Ù‡","Ø¨ÛŒØ³Øª","Ø³ÛŒ","Ú†Ù‡Ù„","Ù¾Ù†Ø¬Ø§Ù‡","Ø´ØµØª","Ù‡ÙØªØ§Ø¯","Ù‡Ø´ØªØ§Ø¯","Ù†ÙˆØ¯"];
const teens=["Ø¯Ù‡","ÛŒØ§Ø²Ø¯Ù‡","Ø¯ÙˆØ§Ø²Ø¯Ù‡","Ø³ÛŒØ²Ø¯Ù‡","Ú†Ù‡Ø§Ø±Ø¯Ù‡","Ù¾Ø§Ù†Ø²Ø¯Ù‡","Ø´Ø§Ù†Ø²Ø¯Ù‡","Ù‡ÙØ¯Ù‡","Ù‡Ø¬Ø¯Ù‡","Ù†ÙˆØ²Ø¯Ù‡"];
const thousands=["","Ù‡Ø²Ø§Ø±","Ù…ÛŒÙ„ÛŒÙˆÙ†","Ù…ÛŒÙ„ÛŒØ§Ø±Ø¯"];
num=Math.floor(num*100)/100;
if(num>999999999) return "Ø¹Ø¯Ø¯ Ø®ÛŒÙ„ÛŒ Ø¨Ø²Ø±Ú¯";
let n=Math.floor(num);
let words=[];
let t=0;
while(n>0){
let chunk=n%1000;
if(chunk>0){
let chunkWords=[];
if(chunk>=100){chunkWords.push(ones[Math.floor(chunk/100)]+" ØµØ¯"); chunk%=100;}
if(chunk>=20){chunkWords.push(tens[Math.floor(chunk/10)]); chunk%=10;}
else if(chunk>=10){chunkWords.push(teens[chunk-10]); chunk=0;}
if(chunk>0) chunkWords.push(ones[chunk]);
words.unshift(chunkWords.join(" ")+" "+thousands[t]);
}
n=Math.floor(n/1000); t++;
}
let fraction=Math.round((num-Math.floor(num))*100);
if(fraction>0) words.push("Ùˆ "+fraction+"/100");
return words.join(" ").replace(/\s+/g," ").trim();
}

function persianToEnglish(str){
    const persianNums = ['Û°','Û±','Û²','Û³','Û´','Ûµ','Û¶','Û·','Û¸','Û¹'];
    const englishNums = ['0','1','2','3','4','5','6','7','8','9'];
    let res = str;
    persianNums.forEach((p,i)=>{res=res.replaceAll(p,englishNums[i]);});
    return res;
}

function toggleCustomerForm(){
let form=document.getElementById("customerForm");
let arrow=document.getElementById("toggleArrow");
if(form.style.display=="none"){form.style.display="block"; arrow.innerText="â–²";}
else{form.style.display="none"; arrow.innerText="â–¼";}
}

function toggleTransactionForm(){
let form=document.getElementById("transactionForm");
let arrow=document.getElementById("toggleTransactionArrow");
if(form.style.display=="none"){form.style.display="block"; arrow.innerText="â–²";}
else{form.style.display="none"; arrow.innerText="â–¼";}
}

function handleAmountInput(el){
    el.value = persianToEnglish(el.value);
    el.value = el.value.replace(/[^0-9.]/g,"");
    let parts = el.value.split(".");
    if(parts.length>2) el.value = parts[0]+"."+parts[1];
    if(el.value) document.getElementById("amountWords").innerText = numberToWords(parseFloat(el.value));
    else document.getElementById("amountWords").innerText = "";
}

function addCustomer(){
let name=document.getElementById("name").value.trim();
let phone=document.getElementById("phone").value.trim();
if(!name) return alert("Ù†Ø§Ù… ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡");
if(customers.some(c=>c.name===name || c.phone===phone)) return alert("Ù†Ø§Ù… ÛŒØ§ Ø´Ù…Ø§Ø±Ù‡ ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø³Øª");
customers.push({id:Date.now(),name,phone,balance:0,transactions:[]});
save();
document.getElementById("name").value="";
document.getElementById("phone").value="";
document.getElementById("customerForm").style.display="none";
document.getElementById("toggleArrow").innerText="â–¼";
render();
}

function addTransaction(){
    let id=document.getElementById("customerSelect").value;
    if(!id){return alert("Ù„Ø·ÙØ§Ù‹ Ù…Ø´ØªØ±ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯");}
    let type=document.getElementById("type").value;
    let amountStr = document.getElementById("amount").value;
    amountStr = persianToEnglish(amountStr);
    let amount=parseFloat(amountStr);
    if(isNaN(amount)) return alert("Ù…Ø¨Ù„Øº ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡");

    let c=customers.find(x=>x.id==id);
    if(type=="deposit"){c.balance=precise(c.balance+amount);}
    else{c.balance=precise(c.balance-amount);}
    let date = new Date().toLocaleString();
    c.transactions.push({type,amount:precise(amount),date});
    save();

    document.getElementById("amount").value="";
    document.getElementById("amountWords").innerText="";
    document.getElementById("transactionForm").style.display="none";
    document.getElementById("toggleTransactionArrow").innerText="â–¼";

    render();

    let status = c.balance >= 0 ? "Ø·Ù„Ø¨Ú©Ø§Ø±" : "Ø¨Ø¯Ù‡Ú©Ø§Ø±";
    let notify=confirm("Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù¾ÛŒØ§Ù…Ú© Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø§Ø·Ù„Ø§Ø¹ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ØŸ");
    if(notify){
        let textMessage = `Ù…Ø´ØªØ±ÛŒ Ú¯Ø±Ø§Ù…ÛŒØŒ ${c.name}
Ø´Ù…Ø§ Ø¯Ø± ØªØ§Ø±ÛŒØ®: ${date}
Ù…Ø¨Ù„Øº: ${amount.toFixed(2)}
Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´: ${type=="deposit"?"Ù¾Ø±Ø¯Ø§Ø®Øª":"Ø¨Ø±Ø¯Ø§Ø´Øª"}
Ø¯Ø± Ø­Ø³Ø§Ø¨ØªØ§Ù† Ù†Ø²Ø¯ Ù…Ø§ Ø«Ø¨Øª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯.
Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ: ${c.balance.toFixed(2)} (${status})
Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ø¢Ø±ÛŒØ§ Ù¾Ø±Ø¯Ø§Ø®Øª`;
        window.location.href = `sms:${c.phone}?body=${encodeURIComponent(textMessage)}`;
    }
}

function toggleHistory(id){
let box=document.getElementById("h"+id);
box.style.display=box.style.display=="block"?"none":"block";
}

function copyBalance(c){
let historyText=c.transactions.map(t=>`${t.type=="deposit"?"â•":"â–"} ${t.amount.toFixed(2)} - ${t.date}`).join("\n");
let fullText=`Ù…Ø´ØªØ±ÛŒ: ${c.name}\nÙ…ÙˆØ¬ÙˆØ¯ÛŒ: ${c.balance.toFixed(2)}\n\nØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§:\n${historyText}\n\nØ­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ø¢Ø±ÛŒØ§ Ù¾Ø±Ø¯Ø§Ø®Øª`;
navigator.clipboard.writeText(fullText);
alert("Ú©Ù¾ÛŒ Ø´Ø¯ Ø¨Ø§ ØªØ§Ø±ÛŒØ®Ú†Ù‡!");
}

function share(c){
let text=`Ø­Ø³Ø§Ø¨ Ù…Ø´ØªØ±ÛŒ ${c.name}\nÙ…ÙˆØ¬ÙˆØ¯ÛŒ: ${c.balance.toFixed(2)}`;
if(navigator.share){navigator.share({text:text});}
else{alert("Ù…Ø±ÙˆØ±Ú¯Ø± Ø§Ø´ØªØ±Ø§Ú© Ú¯Ø°Ø§Ø±ÛŒ Ø±Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯");}
}

function render(){
let list=document.getElementById("customerList");
let select=document.getElementById("customerSelect");
let search=document.getElementById("search").value.toLowerCase();
list.innerHTML=""; select.innerHTML=`<option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø´ØªØ±ÛŒ</option>`;
let totalDebit=0,totalCredit=0,totalAll=0;
let filtered = customers.filter(c=>c.name.toLowerCase().includes(search));
if(filtered.length===0) list.innerHTML="<div>Ù…Ø´ØªØ±ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</div>";
filtered.forEach(c=>{
select.innerHTML+=`<option value="${c.id}">${c.name}</option>`;
let statusClass=c.balance>=0?"pos":"neg";
if(c.balance>=0) totalCredit+=c.balance; else totalDebit+=Math.abs(c.balance);
totalAll+=c.balance;
let history=c.transactions.map(t=>`<div>${t.type=="deposit"?"â•":"â–"} ${t.amount.toFixed(2)} - ${t.date}</div>`).join("");
list.innerHTML+=`
<div class="customer">
<strong>${c.name}</strong>
<div class="small">${c.phone}</div>
<div class="balance ${statusClass}">${c.balance.toFixed(2)} <span class="status">${c.balance>=0?"Ø·Ù„Ø¨Ú©Ø§Ø±":"Ø¨Ø¯Ù‡Ú©Ø§Ø±"}</span></div>
<div>
<button class="btn-copy" onclick="copyBalance(customers.find(x=>x.id==${c.id}))">Ú©Ù¾ÛŒ</button>
<button class="btn-history" onclick="toggleHistory(${c.id})">Ø³Ø§Ø¨Ù‚Ù‡</button>
<button class="btn-share" onclick="share(customers.find(x=>x.id==${c.id}))">Ø§Ø´ØªØ±Ø§Ú©</button>
</div>
<div class="historyBox" id="h${c.id}">${history || "ØªØ±Ø§Ú©Ù†Ø´ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"}</div>
</div>
`;
});
document.getElementById("totalAll").innerText=`Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ Ø³ÛŒØ³ØªÙ…: ${totalAll.toFixed(2)}`;
document.getElementById("totalDebit").innerText=`Ø¬Ù…Ø¹ Ú©Ù„ Ø¨Ø¯Ù‡Ú©Ø§Ø±ÛŒ: ${totalDebit.toFixed(2)}`;
document.getElementById("totalCredit").innerText=`Ø¬Ù…Ø¹ Ú©Ù„ Ø·Ù„Ø¨Ú©Ø§Ø±ÛŒ: ${totalCredit.toFixed(2)}`;
}

render();
</script>
</body>
</html>